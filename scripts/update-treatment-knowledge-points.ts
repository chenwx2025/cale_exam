// 脚本：为治疗和专业职责部分添加详细的知识点信息
import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient()

// 治疗和专业职责相关知识点详细数据
const treatmentKnowledgePoints = [
  {
    code: 'DOMAIN_3A_ACU_SELECTION',
    keyPoints: [
      {
        title: '循经取穴原则',
        description: '根据经络循行路线和病变部位选择腧穴。经络所过，主治所及，这是针灸选穴的基本原则。需要熟悉十四经脉的循行路线和主治范围。',
        examples: [
          '手阳明大肠经：治疗头面、五官、咽喉疾病',
          '足阳明胃经：治疗胃肠、头面疾病',
          '手太阴肺经：治疗呼吸系统疾病',
          '足厥阴肝经：治疗肝胆、生殖系统疾病'
        ]
      },
      {
        title: '辨证配穴方法',
        description: '根据中医辨证结果选择相应的腧穴组合。不同的证型需要选择不同的穴位搭配，体现个体化治疗原则。',
        examples: [
          '肝郁气滞：太冲、期门、内关',
          '脾胃虚弱：足三里、中脘、脾俞',
          '肾阳虚：肾俞、命门、关元',
          '气血两虚：气海、血海、足三里'
        ]
      },
      {
        title: '特定穴应用',
        description: '掌握五输穴、原穴、络穴、背俞穴、募穴等特定穴的特点和应用。特定穴有其特殊的治疗作用，临床应用广泛。',
        examples: [
          '五输穴：井主心下满，荥主身热，输主体重节痛，经主喘咳寒热，合主逆气而泄',
          '原穴：治疗脏腑原气疾病',
          '络穴：治疗表里经病',
          '背俞穴：治疗相应脏腑疾病',
          '募穴：治疗脏腑疾病，多与背俞穴配伍'
        ]
      },
      {
        title: '远近配穴原则',
        description: '近部取穴与远部取穴相结合，增强治疗效果。远近配穴是针灸临床最常用的配穴方法之一。',
        examples: [
          '头痛：局部取穴（百会、太阳）+ 远道取穴（合谷、太冲）',
          '胃痛：局部取穴（中脘、梁门）+ 远道取穴（足三里、内关）',
          '腰痛：局部取穴（腰阳关、委中）+ 远道取穴（后溪）'
        ]
      },
      {
        title: '对症选穴技巧',
        description: '针对具体症状选择特效穴位。某些穴位对特定症状有显著疗效，临床应熟练掌握。',
        examples: [
          '止痛：合谷（头面痛）、内关（胸痛）、阳陵泉（胁痛）',
          '退热：大椎、曲池',
          '止呕：内关、足三里',
          '安神：神门、三阴交',
          '通便：天枢、支沟'
        ]
      }
    ],
    studyTips: '针刺选穴是针灸治疗的核心环节。建议：\n1. 熟记十四经脉的循行和主治\n2. 掌握常见病证的配穴方案\n3. 理解特定穴的应用规律\n4. 多做配穴练习题，培养临床思维\n5. 记忆常用穴位的主治功能',
    detailedInfo: '本部分考查针刺选穴的基本原则和方法：\n• 循经取穴的理论基础\n• 辨证配穴的思路\n• 特定穴的分类和应用\n• 远近配穴、上下配穴等配穴方法\n• 常见病证的标准配穴方案\n\n考试会通过病例给出证型，要求选择合适的穴位组合。需要熟练掌握经络理论和腧穴功能。'
  },
  {
    code: 'DOMAIN_3B_ACU_TECHNIQUE',
    keyPoints: [
      {
        title: '腧穴定位方法',
        description: '准确的穴位定位是针灸治疗成功的前提。主要包括骨度分寸法、体表标志法、手指同身寸法等。',
        examples: [
          '骨度分寸法：前发际至后发际为12寸',
          '体表标志法：脐中为神阙穴',
          '手指同身寸：拇指指间关节横纹为1寸',
          '简便取穴：两耳尖连线中点为百会穴'
        ]
      },
      {
        title: '针刺角度与深度',
        description: '根据不同部位和治疗需要，选择合适的针刺角度和深度。不同穴位有不同的针刺要求，需严格遵守安全规范。',
        examples: [
          '直刺：与皮肤呈90度，如足三里、合谷',
          '斜刺：与皮肤呈45度，如头皮穴',
          '横刺：与皮肤呈15-30度，如鱼腰、阳白',
          '危险部位：膻中不宜深刺，防止气胸'
        ]
      },
      {
        title: '针刺手法',
        description: '掌握基本的行针手法，包括提插、捻转、烧山火、透天凉等。不同手法有不同的治疗作用。',
        examples: [
          '提插法：上下提插针体，补虚泻实',
          '捻转法：左右旋转针柄',
          '烧山火：温补手法，用于虚寒证',
          '透天凉：清泻手法，用于实热证',
          '平补平泻：不偏补不偏泻'
        ]
      },
      {
        title: '得气与针感',
        description: '得气是针刺疗效的关键。医者感觉针下沉紧，患者感觉酸麻胀重，是针刺得气的标志。',
        examples: [
          '医者手下感：针下沉紧、如鱼吞钩',
          '患者感觉：酸、麻、胀、重',
          '促进得气：提插捻转、循按穴位',
          '针感传导：沿经络循行路线传导'
        ]
      },
      {
        title: '留针与出针',
        description: '掌握留针时间和正确的出针方法。留针可以巩固疗效，出针方法影响治疗效果。',
        examples: [
          '留针时间：一般20-30分钟',
          '出针方法：缓慢旋转提起，按压针孔',
          '急性病：可适当缩短留针时间',
          '慢性病：可适当延长留针时间'
        ]
      }
    ],
    studyTips: '取穴定位与针刺手法是针灸操作的基础。建议：\n1. 熟记常用穴位的准确定位\n2. 理解不同针刺角度和深度的原因\n3. 掌握基本行针手法的操作要领\n4. 重视安全针刺，避免意外\n5. 多做实际操作练习',
    detailedInfo: '本部分考查针灸操作技术的掌握程度：\n• 腧穴的准确定位方法\n• 针刺的角度、深度和方向\n• 基本针刺手法\n• 得气的判断标准\n• 留针和出针的注意事项\n• 特殊部位的针刺要求\n\n强调规范操作和患者安全，需要理论与实践相结合。'
  },
  {
    code: 'DOMAIN_3C_ADJUNCTIVE',
    keyPoints: [
      {
        title: '灸法分类与应用',
        description: '灸法是用艾绒或其他药物在穴位上烧灼、温熨的治疗方法。主要用于虚寒证、慢性病的治疗。',
        examples: [
          '艾条灸：悬起灸、实按灸、回旋灸',
          '艾炷灸：直接灸、间接灸（隔姜灸、隔盐灸）',
          '温针灸：针柄上加艾，针灸并用',
          '适应症：虚寒证、痹症、泄泻、痛经等',
          '禁忌症：热证、阴虚证、面部禁直接灸'
        ]
      },
      {
        title: '拔罐疗法',
        description: '利用罐内负压吸附于体表，通过温热和吸拔作用治疗疾病。常用于祛风散寒、活血化瘀。',
        examples: [
          '闪罐：快速吸拔后立即起罐，反复操作',
          '留罐：吸拔后留置5-15分钟',
          '走罐：涂抹润滑油后推动罐体',
          '刺络拔罐：先刺络放血，再拔罐',
          '适应症：感冒、咳嗽、腰背痛、痹症'
        ]
      },
      {
        title: '电针疗法',
        description: '将电针仪输出的脉冲电流通过针体作用于穴位和经络。增强针刺效果，常用于镇痛和肌肉萎缩。',
        examples: [
          '疏密波：镇痛效果好',
          '连续波：适用于肌肉萎缩',
          '断续波：适用于痉挛性疾病',
          '电流强度：以患者耐受为度',
          '注意事项：心脏病患者慎用'
        ]
      },
      {
        title: '耳穴疗法',
        description: '在耳廓相应穴位进行针刺、压豆或埋针治疗。耳穴反映全身脏腑功能，操作简便，应用广泛。',
        examples: [
          '耳穴压豆：用王不留行籽贴压',
          '耳穴埋针：用图钉型皮内针',
          '常用穴位：神门、皮质下、交感、内分泌',
          '适应症：失眠、痛症、戒烟、减肥'
        ]
      },
      {
        title: '推拿按摩手法',
        description: '运用各种手法作用于人体体表，以调整机体生理、病理状况。常见手法包括按、摩、推、拿等。',
        examples: [
          '按法：用拇指或掌根按压穴位',
          '摩法：用掌面在体表环形摩动',
          '推法：用手指或掌根在经络上推动',
          '拿法：用拇指与其他四指对称用力提拿',
          '适应症：颈肩腰腿痛、消化不良、小儿疾病'
        ]
      }
    ],
    studyTips: '辅助治疗方式扩展了中医治疗手段。建议：\n1. 了解各种辅助疗法的适应症和禁忌症\n2. 掌握灸法、拔罐的基本操作方法\n3. 理解电针、耳穴的应用原理\n4. 注意安全操作规范\n5. 学习与针刺配合使用的技巧',
    detailedInfo: '本部分考查针刺以外的辅助治疗方法：\n• 各种灸法的分类和应用\n• 拔罐疗法的操作方法\n• 电针疗法的参数选择\n• 耳穴疗法的穴位定位\n• 推拿按摩的基本手法\n• 刮痧、三棱针等其他疗法\n\n需要了解各种疗法的适应症、禁忌症和操作要点。'
  },
  {
    code: 'DOMAIN_3D_HERBAL',
    keyPoints: [
      {
        title: '中药性味归经',
        description: '药物的性味归经决定其治疗作用和应用范围。四气（寒、热、温、凉）五味（辛、甘、酸、苦、咸）是中药的基本属性。',
        examples: [
          '寒凉药：清热解毒，如黄连、栀子',
          '温热药：温阳散寒，如附子、肉桂',
          '辛味药：发散解表，如麻黄、桂枝',
          '苦味药：清热燥湿，如黄芩、龙胆草',
          '甘味药：补益和中，如人参、甘草'
        ]
      },
      {
        title: '方剂组成原则',
        description: '君臣佐使是方剂组成的基本原则。君药是主药，臣药辅助君药，佐药制约君臣药的副作用或反佐，使药引经或调和。',
        examples: [
          '四君子汤：人参（君）、白术（臣）、茯苓（佐）、甘草（使）',
          '麻黄汤：麻黄（君）、桂枝（臣）、杏仁（佐）、甘草（使）',
          '君药：针对主证的主要药物',
          '臣药：辅助君药加强疗效',
          '佐药：制约毒副作用或反佐',
          '使药：引经或调和诸药'
        ]
      },
      {
        title: '常用方剂应用',
        description: '熟练掌握临床常用方剂的组成、功效和适应症。经典方剂是中医治疗的基础，需要深入理解。',
        examples: [
          '小柴胡汤：和解少阳，治疗往来寒热',
          '四物汤：补血调经，治疗血虚证',
          '六味地黄丸：滋阴补肾，治疗肾阴虚',
          '理中丸：温中散寒，治疗脾胃虚寒',
          '桂枝汤：解肌发表，治疗风寒表虚证'
        ]
      },
      {
        title: '中药配伍禁忌',
        description: '了解中药配伍的禁忌，确保用药安全。十八反、十九畏是中药配伍禁忌的重要内容。',
        examples: [
          '十八反：甘草反甘遂、大戟、海藻、芫花',
          '十九畏：硫磺畏朴硝，巴豆畏牵牛',
          '妊娠禁忌：巴豆、牵牛、大戟等',
          '服药禁忌：服清热药忌辛辣，服温补药忌生冷'
        ]
      },
      {
        title: '中药剂量与煎服',
        description: '掌握中药的常用剂量和正确的煎煮方法。剂量和煎法直接影响药效。',
        examples: [
          '一般剂量：3-10克',
          '大剂量：15-30克（石膏、生地等）',
          '小剂量：1-3克（细辛、麝香等）',
          '先煎：矿物药、贝壳类',
          '后下：薄荷、砂仁等芳香药',
          '包煎：车前子等细小种子'
        ]
      }
    ],
    studyTips: '中药治疗是中医的重要组成部分。建议：\n1. 熟记常用中药的性味归经和功效\n2. 掌握经典方剂的组成和应用\n3. 理解君臣佐使的配伍原则\n4. 牢记十八反十九畏等禁忌\n5. 了解中药的剂量范围和煎服方法',
    detailedInfo: '本部分考查中药和方剂的基本知识：\n• 中药的性味归经和功效\n• 方剂组成的君臣佐使原则\n• 常用经典方剂的应用\n• 中药配伍禁忌（十八反十九畏）\n• 妊娠用药禁忌\n• 中药剂量和煎服方法\n\n虽然CALE考试以针灸为主，但基本的中药知识也是必考内容。'
  },
  {
    code: 'DOMAIN_4_PROFESSIONAL',
    keyPoints: [
      {
        title: '职业道德规范',
        description: '作为执业针灸师，必须遵守职业道德，维护患者权益，保持专业操守。',
        examples: [
          '尊重患者：保护隐私，尊重患者选择权',
          '诚实守信：如实告知病情和治疗方案',
          '平等对待：不因种族、性别、信仰歧视',
          '保密原则：保护患者医疗信息',
          '持续学习：不断提升专业水平'
        ]
      },
      {
        title: '知情同意原则',
        description: '在治疗前必须向患者充分说明治疗方案、可能的风险和预期效果，获得患者的知情同意。',
        examples: [
          '治疗方案说明：解释治疗方法和过程',
          '风险告知：说明可能的不良反应',
          '预期效果：告知治疗的预期结果',
          '替代方案：提供其他治疗选择',
          '签署同意书：重要治疗需书面同意'
        ]
      },
      {
        title: '感染控制与预防',
        description: '严格执行感染控制措施，防止医源性感染。这是医疗安全的基本要求。',
        examples: [
          '手卫生：治疗前后洗手或使用手消毒剂',
          '一次性针具：使用一次性无菌针灸针',
          '皮肤消毒：75%酒精消毒针刺部位',
          '医疗废物：正确分类和处理针具',
          '环境卫生：保持治疗室清洁'
        ]
      },
      {
        title: '急救与意外处理',
        description: '掌握针灸临床常见意外情况的预防和处理方法，确保患者安全。',
        examples: [
          '晕针处理：立即停针，平卧，掐人中',
          '滞针处理：放松肌肉，缓慢旋转',
          '断针处理：保持原位，取出或手术',
          '血肿处理：立即拔针，压迫止血',
          '气胸处理：立即停针，送医急救',
          '预防措施：选择合适体位，注意深度'
        ]
      },
      {
        title: '医疗记录管理',
        description: '完整、准确、及时地记录患者病历，这是法律要求也是医疗质量保证。',
        examples: [
          '初诊记录：主诉、现病史、体格检查',
          '诊断记录：中医诊断和西医诊断',
          '治疗记录：穴位选择、操作方法',
          '疗效评估：记录治疗效果和患者反馈',
          '保存期限：至少保存7年',
          '隐私保护：严格保密，授权访问'
        ]
      },
      {
        title: '执业范围与转诊',
        description: '明确自己的执业范围，遇到超出能力的情况及时转诊，保障患者安全。',
        examples: [
          '执业范围：针灸、推拿、中药等',
          '禁止行为：不得从事执照外的医疗活动',
          '及时转诊：急重症、恶性肿瘤等',
          '会诊合作：必要时与其他医师会诊',
          '持续教育：参加继续教育，保持执照有效'
        ]
      },
      {
        title: '法律法规遵守',
        description: '了解并遵守加州针灸执业相关的法律法规，合法执业。',
        examples: [
          '执照要求：持有有效的加州针灸执照',
          '继续教育：每两年完成50学分',
          '保险要求：购买医疗责任保险',
          '广告规范：不得虚假宣传疗效',
          '处方权限：了解中药处方的限制',
          '举报义务：发现虐待等需举报'
        ]
      }
    ],
    studyTips: '专业职责是执业针灸师的基本要求。建议：\n1. 熟悉加州针灸执业法规\n2. 掌握医疗安全和感染控制要求\n3. 了解患者权益保护的相关规定\n4. 学习急救和意外处理方法\n5. 理解职业道德的重要性\n6. 关注最新的法规变化',
    detailedInfo: '本部分考查针灸师的专业素养和职业规范：\n• 职业道德和医学伦理\n• 知情同意和患者权益\n• 感染控制和医疗安全\n• 急救与意外处理\n• 医疗记录的规范管理\n• 执业范围和转诊原则\n• 加州针灸相关法律法规\n\n这是执业的基础，虽然占比不高但非常重要，关系到能否安全合法执业。'
  }
]

async function updateTreatmentKnowledgePoints() {
  try {
    console.log('开始更新治疗和专业职责知识点数据...\n')

    for (const kp of treatmentKnowledgePoints) {
      // 查找对应的分类
      const category = await prisma.category.findFirst({
        where: {
          code: kp.code,
          examType: 'cale'
        }
      })

      if (!category) {
        console.log(`⚠️  未找到分类: ${kp.code}`)
        continue
      }

      // 更新分类数据
      await prisma.category.update({
        where: { id: category.id },
        data: {
          keyPoints: JSON.stringify(kp.keyPoints),
          studyTips: kp.studyTips,
          detailedInfo: kp.detailedInfo
        }
      })

      console.log(`✅ 已更新: ${category.name} (${kp.code})`)
      console.log(`   - 知识要点: ${kp.keyPoints.length} 个`)
      console.log(`   - 题目数量: ${category.questionCount || 0} 题`)
      console.log(`   - 考试占比: ${category.weight || 0}%\n`)
    }

    console.log('✨ 治疗和专业职责知识点数据更新完成！')
    console.log('\n📊 更新统计：')
    console.log(`   - Domain 3A (针刺选穴): 5个核心要点`)
    console.log(`   - Domain 3B (取穴定位与针刺手法): 5个核心要点`)
    console.log(`   - Domain 3C (辅助治疗方式): 5个核心要点`)
    console.log(`   - Domain 3D (中药治疗): 5个核心要点`)
    console.log(`   - Domain 4 (专业职责): 7个核心要点`)

  } catch (error) {
    console.error('❌ 更新失败:', error)
  } finally {
    await prisma.$disconnect()
  }
}

// 执行更新
updateTreatmentKnowledgePoints()
