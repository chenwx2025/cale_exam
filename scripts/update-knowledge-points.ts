// 脚本：为CALE考试分类添加详细的知识点信息
import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient()

// CALE考试知识点详细数据
const caleKnowledgePoints = [
  {
    code: 'DOMAIN_1_ASSESSMENT',
    keyPoints: [
      {
        title: '四诊合参',
        description: '综合运用望、闻、问、切四种诊断方法，全面评估患者的健康状况。四诊合参是中医诊断的核心原则，要求医师将四诊所得信息综合分析，得出准确的诊断结论。',
        examples: [
          '望诊：观察患者面色、舌象、神态等',
          '闻诊：听患者声音、嗅其气味',
          '问诊：询问病史、症状、生活习惯',
          '切诊：触诊脉象、腹诊等'
        ]
      },
      {
        title: '舌诊要点',
        description: '舌诊是中医独特的诊断方法，通过观察舌质、舌苔的变化来判断疾病的性质、部位和预后。舌质反映脏腑气血盛衰，舌苔反映病邪深浅和胃气存亡。',
        examples: [
          '舌质：淡白、淡红、红、绛、紫等',
          '舌苔：白苔、黄苔、灰苔、黑苔',
          '舌形：胖大、瘦小、裂纹、齿痕',
          '舌态：强硬、痿软、颤动、歪斜'
        ]
      },
      {
        title: '脉诊技巧',
        description: '脉诊是通过触摸桡动脉来判断气血运行、脏腑功能的方法。需掌握寸关尺三部、浮中沉三候的诊脉方法，以及常见28种脉象的特点和临床意义。',
        examples: [
          '浮脉：轻取即得，主表证',
          '沉脉：重按始得，主里证',
          '数脉：脉搏快速，主热证',
          '迟脉：脉搏缓慢，主寒证',
          '滑脉：流利圆滑，主痰湿或妊娠',
          '涩脉：艰涩不畅，主血瘀或血虚'
        ]
      },
      {
        title: '辨证论治基础',
        description: '掌握八纲辨证（阴阳、表里、寒热、虚实）的基本方法，以及脏腑辨证、六经辨证、卫气营血辨证等常用辨证方法。',
        examples: [
          '表证：发热恶寒、脉浮',
          '里证：内脏功能失调',
          '寒证：畏寒喜暖、苔白',
          '热证：发热口渴、苔黄',
          '虚证：久病体弱、脉细',
          '实证：邪气盛实、脉实有力'
        ]
      }
    ],
    studyTips: '评估与诊断是中医临床的基础，占考试比重最大。建议：\n1. 熟练掌握四诊的基本方法和要点\n2. 重点记忆常见舌象、脉象的特征和临床意义\n3. 多看临床案例，培养综合分析能力\n4. 练习辨证思维，建立完整的诊断思路',
    detailedInfo: '本部分涵盖中医诊断的基本方法和辨证论治的核心内容。主要包括：\n• 四诊（望闻问切）的基本方法和技巧\n• 舌诊、脉诊的详细要点\n• 八纲辨证的基本原则\n• 脏腑辨证、六经辨证等辨证方法\n• 病因病机分析\n\n考试时会通过病例题考查辨证能力，需要综合运用所学知识进行分析判断。'
  },
  {
    code: 'DOMAIN_2_DIAGNOSIS',
    keyPoints: [
      {
        title: '中医病名诊断',
        description: '掌握常见中医病名的诊断标准、鉴别要点。中医病名诊断要求准确识别疾病的病位、病性、病势，为治疗提供依据。',
        examples: [
          '外感病：感冒、咳嗽、哮喘等',
          '内伤病：眩晕、心悸、胃痛等',
          '妇科病：月经不调、痛经、带下等',
          '儿科病：小儿感冒、泄泻、厌食等'
        ]
      },
      {
        title: '证型辨别',
        description: '能够根据临床表现准确辨别证型，如肝郁气滞、脾胃虚弱、肾阳虚等。证型辨别是确定治疗方案的关键。',
        examples: [
          '肝郁气滞：胸胁胀痛、情绪抑郁',
          '脾胃虚弱：食欲不振、大便溏薄',
          '肾阳虚：畏寒肢冷、腰膝酸软',
          '心血虚：心悸失眠、面色苍白'
        ]
      },
      {
        title: '西医诊断基础',
        description: '掌握基本的西医诊断知识，包括常见疾病的诊断标准、实验室检查结果判读等。中西医结合诊断是现代中医的重要能力。',
        examples: [
          '高血压诊断标准',
          '糖尿病诊断指标',
          '心电图基本判读',
          '血常规结果分析'
        ]
      }
    ],
    studyTips: '诊断部分要求准确性和规范性。建议：\n1. 熟记常见病名的诊断标准\n2. 掌握各证型的典型症状\n3. 了解基本的西医诊断知识\n4. 注意中西医诊断的结合运用',
    detailedInfo: '本部分考查对疾病诊断的掌握程度，包括：\n• 中医病名诊断\n• 证型辨别\n• 西医诊断基础\n• 鉴别诊断要点\n\n需要能够根据病例准确做出诊断，并说明诊断依据。'
  },
  {
    code: 'DOMAIN_3_TREATMENT_PLANNING',
    keyPoints: [
      {
        title: '治疗原则确定',
        description: '根据辨证结果确定正确的治疗原则，如扶正祛邪、标本缓急、因时因地因人制宜等。',
        examples: [
          '扶正祛邪：正虚邪实时的治疗策略',
          '标本缓急：急则治标，缓则治本',
          '因人制宜：根据年龄、体质调整治法',
          '因时制宜：根据季节调整用药'
        ]
      },
      {
        title: '针灸处方设计',
        description: '能够根据病情选择合适的腧穴，制定完整的针灸治疗方案。包括主穴、配穴的选择，针刺手法的确定等。',
        examples: [
          '循经取穴：根据经络循行选穴',
          '辨证选穴：根据证型配穴',
          '对症选穴：针对症状选用特定穴位',
          '特定穴应用：五输穴、原穴、络穴等'
        ]
      },
      {
        title: '中药处方原则',
        description: '掌握方剂配伍原则、用药禁忌、剂量调整等基本知识。能够根据病情选择合适的方剂并进行加减化裁。',
        examples: [
          '君臣佐使：方剂组成原则',
          '十八反十九畏：配伍禁忌',
          '妊娠用药禁忌',
          '方剂加减变化'
        ]
      }
    ],
    studyTips: '治疗计划制定考查临床思维能力。建议：\n1. 熟练掌握常用治法和方剂\n2. 理解针灸选穴原则\n3. 掌握用药禁忌和注意事项\n4. 多练习病例分析和方案制定',
    detailedInfo: '本部分考查制定完整治疗方案的能力：\n• 确定治疗原则\n• 设计针灸处方\n• 拟定中药方剂\n• 制定综合治疗方案\n\n需要考虑治疗的安全性、有效性和个体化原则。'
  },
  {
    code: 'DOMAIN_4_TREATMENT',
    keyPoints: [
      {
        title: '针刺技术规范',
        description: '掌握正确的针刺操作方法，包括进针、行针、留针、出针等各个环节的技术要求和注意事项。',
        examples: [
          '消毒规范：严格无菌操作',
          '进针方法：直刺、斜刺、横刺',
          '针刺深度：根据部位确定',
          '针刺手法：提插、捻转',
          '留针时间：一般20-30分钟',
          '针刺反应：晕针、滞针的处理'
        ]
      },
      {
        title: '灸法应用',
        description: '熟悉各种灸法的操作技术和适应症，包括艾条灸、艾炷灸、温针灸等。',
        examples: [
          '艾条灸：悬起灸、实按灸',
          '艾炷灸：直接灸、间接灸',
          '温针灸：针柄上加艾',
          '灸法禁忌：面部慎灸、孕妇禁灸'
        ]
      },
      {
        title: '其他治疗技术',
        description: '掌握拔罐、推拿、刮痧等辅助治疗方法的操作规范和适应症。',
        examples: [
          '拔罐：闪罐、留罐、走罐',
          '推拿：按、摩、推、拿等手法',
          '刮痧：适应症和禁忌症',
          '耳穴：压豆、埋针'
        ]
      }
    ],
    studyTips: '治疗实施部分注重操作规范。建议：\n1. 熟记各种治疗技术的操作步骤\n2. 掌握安全操作和禁忌症\n3. 了解常见并发症的预防和处理\n4. 注重无菌观念和患者安全',
    detailedInfo: '本部分考查实际治疗技能的掌握：\n• 针刺操作技术\n• 灸法应用\n• 拔罐、推拿等辅助疗法\n• 治疗安全和并发症处理\n\n强调规范操作和患者安全。'
  },
  {
    code: 'DOMAIN_5_SAFETY',
    keyPoints: [
      {
        title: '针灸安全规范',
        description: '掌握针灸治疗的安全要求，包括消毒灭菌、防止交叉感染、避免损伤重要脏器等。',
        examples: [
          '一次性针具的使用',
          '严格消毒程序',
          '危险部位针刺注意事项',
          '预防气胸、折针等意外',
          '晕针的预防和急救'
        ]
      },
      {
        title: '感染控制',
        description: '了解针灸临床中的感染控制措施，防止医源性感染的发生。',
        examples: [
          '手卫生规范',
          '针具消毒标准',
          '治疗室环境卫生',
          '医疗废物处理',
          '血源性传播病预防'
        ]
      },
      {
        title: '急救处理',
        description: '掌握针灸临床常见意外情况的急救处理方法。',
        examples: [
          '晕针：平卧、掐人中',
          '滞针：放松、缓慢转动',
          '血肿：压迫止血',
          '气胸：立即停针、送医'
        ]
      }
    ],
    studyTips: '安全与伦理至关重要。建议：\n1. 牢记安全操作规范\n2. 了解感染控制要求\n3. 掌握急救处理方法\n4. 熟悉职业道德规范',
    detailedInfo: '本部分考查医疗安全意识：\n• 针灸操作安全\n• 感染控制措施\n• 急救处理能力\n• 职业道德规范\n\n医疗安全是执业的底线要求。'
  }
]

async function updateKnowledgePoints() {
  try {
    console.log('开始更新知识点数据...')

    for (const kp of caleKnowledgePoints) {
      // 查找对应的分类
      const category = await prisma.category.findFirst({
        where: {
          code: kp.code,
          examType: 'cale'
        }
      })

      if (!category) {
        console.log(`⚠️  未找到分类: ${kp.code}`)
        continue
      }

      // 更新分类数据
      await prisma.category.update({
        where: { id: category.id },
        data: {
          keyPoints: JSON.stringify(kp.keyPoints),
          studyTips: kp.studyTips,
          detailedInfo: kp.detailedInfo
        }
      })

      console.log(`✅ 已更新: ${category.name} (${kp.code})`)
    }

    console.log('\n✨ 知识点数据更新完成！')
  } catch (error) {
    console.error('❌ 更新失败:', error)
  } finally {
    await prisma.$disconnect()
  }
}

// 执行更新
updateKnowledgePoints()
